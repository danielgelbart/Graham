%ul.list-group
  %li.list-group-item.row.list-group-item-info.bold
    Market Data
  %li.list-group-item.row
    %div.col-md-2
      Companies 
    %span.col-md-6
      = "Excluding dup classes for #{@exclude_list.to_s}"
    %span.bold.col-md-4
      = @comp_data.size
  %li.list-group-item.row
    %div.col-md-8
      Total / Public Market Cap
    %span.bold.col-md-2
      = is_to_s @total_market_cap
    %span.bold.col-md-2
      = is_to_s @pub_market_cap
  %li.list-group-item.row
    %div.col-md-8
      Total Market Earnings
    %span.bold.col-md-4
      = is_to_s @total_earnings
  %li.list-group-item.row
    %div.col-md-8
      Market PE
    %span.bold.col-md-4
      = short_float @total_market_cap / @total_earnings.to_f
  %li.list-group-item.row
    %div.col-md-3
      = "S&P 500 data using divisor #{@divisor}"
    %span.bold.col-md-3
      = "Price #{short_float @pub_market_cap/@divisor}"
    %span.bold.col-md-3
      = "Earnings #{ short_float @total_earnings.to_f/@divisor}"
    %span.bold.col-md-3
      = "PE #{ short_float @pub_market_cap / @total_earnings.to_f }"


- count = 0
%table.stock-list
  %thead
    %th
      = "#"
    %th
      Ticker
    %th
      ttm Earning
    %th
      ttm Eps   
    %th
      Float
    %th
      Price
    %th
      Market Cap  
    %th  
      MC / TE
    %th
      P / E
  %tbody
    - @comp_data.each do |d|
      %tr
        %td
          = count += 1 
        %td
          = link_to d.ticker, stock_path(Stock.find_by_ticker(d.ticker))
        %td
          = is_to_s d.ttm_earnings
        %td
          = short_float d.ttm_eps
        %td
          = is_to_s d.num_shares
        %td
          = "$ " + d.price.to_s
        %td
          = is_to_s d.market_cap
        %td
          = short_float d.market_pe
        %td
          = short_float d.pe
        %td
          .red 
            = "NO"


